<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The concordance statistic compute the agreement between an observed
response and a predictor.  It is closely related to Kendall's tau-a and
tau-b, Goodman's gamma, and Somers' d, all of which can also be
calculated from the results of this function."><title>Compute the concordance statistic for data or a model — concordance • survival</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the concordance statistic for data or a model — concordance"><meta property="og:description" content="The concordance statistic compute the agreement between an observed
response and a predictor.  It is closely related to Kendall's tau-a and
tau-b, Goodman's gamma, and Somers' d, all of which can also be
calculated from the results of this function."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">survival</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example-analysis.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/therneau/survival/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute the concordance statistic for data or a model</h1>
      
      <div class="d-none name"><code>concordance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The concordance statistic compute the agreement between an observed
response and a predictor.  It is closely related to Kendall's tau-a and
tau-b, Goodman's gamma, and Somers' d, all of which can also be
calculated from the results of this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">concordance</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">concordance</span><span class="op">(</span><span class="va">object</span>, <span class="va">data</span>, <span class="va">weights</span>, <span class="va">subset</span>, <span class="va">na.action</span>,</span>
<span>  <span class="va">cluster</span>, <span class="va">ymin</span>, <span class="va">ymax</span>, timewt<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"S"</span>, <span class="st">"S/G"</span>, <span class="st">"n/G2"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>  influence<span class="op">=</span><span class="fl">0</span>, ranks <span class="op">=</span> <span class="cn">FALSE</span>, reverse<span class="op">=</span><span class="cn">FALSE</span>, timefix<span class="op">=</span><span class="cn">TRUE</span>, keepstrata<span class="op">=</span><span class="fl">10</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for lm</span></span>
<span><span class="fu">concordance</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, <span class="va">newdata</span>, <span class="va">cluster</span>, <span class="va">ymin</span>, <span class="va">ymax</span>,</span>
<span>  influence<span class="op">=</span><span class="fl">0</span>, ranks<span class="op">=</span><span class="cn">FALSE</span>, timefix<span class="op">=</span><span class="cn">TRUE</span>, keepstrata<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># S3 method for coxph</span></span>
<span><span class="fu">concordance</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, <span class="va">newdata</span>, <span class="va">cluster</span>, <span class="va">ymin</span>, <span class="va">ymax</span>,</span>
<span>  timewt<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"S"</span>, <span class="st">"S/G"</span>, <span class="st">"n/G2"</span>, <span class="st">"I"</span><span class="op">)</span>, influence<span class="op">=</span><span class="fl">0</span>,</span>
<span>  ranks<span class="op">=</span><span class="cn">FALSE</span>, timefix<span class="op">=</span><span class="cn">TRUE</span>, keepstrata<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># S3 method for survreg</span></span>
<span><span class="fu">concordance</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, <span class="va">newdata</span>, <span class="va">cluster</span>, <span class="va">ymin</span>, <span class="va">ymax</span>,</span>
<span>  timewt<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"S"</span>, <span class="st">"S/G"</span>, <span class="st">"n/G2"</span>, <span class="st">"I"</span><span class="op">)</span>, influence<span class="op">=</span><span class="fl">0</span>,</span>
<span>  ranks<span class="op">=</span><span class="cn">FALSE</span>, timefix<span class="op">=</span><span class="cn">TRUE</span>, keepstrata<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>a fitted model or a formula.  The formula should be of
  the form <code>y ~x</code>  or <code>y ~ x + strata(z)</code> with a single
  numeric or survival response and a single predictor.
  Counts of concordant, discordant and tied pairs 
  are computed separately per stratum, and then added.</p></dd>


 <dt>data</dt>
<dd><p>a data.frame in which to interpret the variables named in 
    the <code>formula</code>, or in the <code>subset</code> and the <code>weights</code>
    argument. Only applicable if <code>object</code> is a formula.</p></dd>

  <dt>weights</dt>
<dd><p>optional vector of case weights.
    Only applicable if <code>object</code> is a formula.</p></dd>

  <dt>subset</dt>
<dd><p>expression indicating which subset of the rows of data should be used in 
    the fit.   Only applicable if <code>object</code> is a formula.</p></dd>

  <dt>na.action</dt>
<dd><p>a missing-data filter function.  This is applied to the model.frame
    after any subset argument has been used.  Default is
   <code>options()\$na.action</code>. Only applicable if <code>object</code> is a formula.</p></dd>


  <dt>...</dt>
<dd><p>multiple fitted models are allowed.  Only applicable if
    <code>object</code> is a model object.</p></dd>

  
  <dt>newdata</dt>
<dd><p>optional, a new data frame in which to evaluate (but
    not refit) the models</p></dd>

  
  <dt>cluster</dt>
<dd><p>optional grouping vector for calculating the robust
    variance</p></dd>

  
  <dt>ymin, ymax</dt>
<dd><p>compute the concordance over the restricted range
     ymin &lt;= y &lt;= ymax.  (For survival data this is a time range.)</p></dd>

  <dt>timewt</dt>
<dd><p>the weighting to be applied.  The overall statistic is a
      weighted mean over event times.</p></dd>

  <dt>influence</dt>
<dd><p>1= return the dfbeta vector, 2= return the full
    influence matrix, 3 = return both</p></dd>

  <dt>ranks</dt>
<dd><p>if TRUE, return a data frame containing the
    scaled ranks that make up the overall score.</p></dd>

  <dt>reverse</dt>
<dd><p>if TRUE then assume that larger <code>x</code> values predict
    smaller response values <code>y</code>; a proportional hazards model is
    the common example of this, larger hazard = shorter survival.</p></dd>


  <dt>timefix</dt>
<dd><p>correct for possible rounding error.  See the
    vignette on tied times for more explanation. Essentially, exact ties
    are an important part of the concordance computatation, but "exact"
    can be a subtle issue with floating point numbers.</p></dd>

  <dt>keepstrata</dt>
<dd><p>either TRUE, FALSE, or an integer value.
    Computations are always done within stratum, then added. If the
    total number of strata greater than <code>keepstrata</code>, or
    <code>keepstrata=FALSE</code>, those subtotals are not kept in the output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The concordance is an estimate of
  \(Pr(x_i &lt; x_j | y_i &lt; y_j)\),
  for a model fit replace \(x\) with \(\hat y\), the
  predicted response from the model.
  For a survival outcome some pairs of values
  are not comparable, e.g., censored at time 5 and a death at time 6,
  as we do not know if the first observation will or will not outlive
  the second.  In this case the total number of evaluable pairs is smaller.</p>  
<p>Relatations to other statistics:
  For continuous x and y, 2C- 1 is equal to Somers' d.
  If the response is binary, C is equal to the area under the receiver
  operating curve or AUC.
  For a survival response and binary predictor C is the numerator of
  the Gehan-Wilcoxon test.</p>
<p>A naive compuation requires adding up over all n(n-1)/2 comparisons,
  which can be quite slow for large data sets.
  This routine uses an O(n log(n)) algorithm.
  At each uncensored event time y, compute the rank of x for the subject
  who had the event as compared to the x values for all others with a longer
  survival, where the rank has value between 0 and 1.
  The concordance is a weighted mean of these ranks,
  determined by the <code>timewt</code> option. The rank vector can be
  efficiently updated as subjects are added to the risk set.
  For further details see the vignette.</p>
<p>The variance is based on an infinetesimal jackknife.  One advantage of
  this approach is that it also gives a valid covariance for the
  covariance based on multiple different predicted values, even if those
  predictions come from quite different models.  See for instance the
  example below which has a poisson and two non-nested Cox models.
  This has been useful to compare a machine learning model to a Cox
  model fit, say.
  It is absolutely critical, however, that the predicted values line up
  exactly, with the same observation in each row; otherwise the result
  will be nonsense.  (Be alert to the impact of missing values.)</p>
<p>The <code>timewt</code> option is only applicable to censored data.  In this
  case the default corresponds to Harrell's C statistic, which is
  closely related to the Gehan-Wilcoxon test;
  <code>timewt="S"</code> corrsponds to the Peto-Wilcoxon,
  <code>timewt="S/G"</code> is suggested by Schemper, and
  <code>timewt="n/G2"</code> corresponds to Uno's C.
  It turns out that the Schemper and Uno weights are computationally
  identical, we have retained both option labels as a user convenience.
  The <code>timewt= "I"</code> option is related to the log-rank
  statistic.</p>  
<p>When the number of strata is very large, such as in a conditional
  logistic regression for instance (<code>clogit</code> function), a much
  faster computation is available when the individual strata results
  are not retained; use <code>keepstrata=FALSE</code> or <code>keepstrata=0</code>
  to do so. In the general case the <code>keepstrata = 10</code>
  default simply keeps the printout managable: it retains and prints
  per-strata counts if the number of strata is &lt;= 10.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>concordance</code> containing the following
  components:</p>
<dl><dt>concordance</dt>
<dd><p>the estimated concordance value or values</p></dd>

  <dt>count</dt>
<dd><p>a vector containing the number of concordant pairs,
     discordant, tied on x but not y, tied on y but not x, and tied on
     both x and y</p></dd>

  <dt>n</dt>
<dd><p>the number of observations</p></dd>

  <dt>var</dt>
<dd><p>a vector containing the estimated variance of the
    concordance based on the infinitesimal jackknife (IJ) method.
    If there are multiple models it contains the estimtated
    variance/covariance matrix.</p></dd>

  <dt>cvar</dt>
<dd><p>a vector containing the estimated variance(s) of the
    concordance values, based on the variance formula for the associated
    score test from a proportional hazards model.  (This was the primary
    variance used in the <code>survConcordance</code> function.)</p></dd>

   <dt>dfbeta</dt>
<dd><p>optional, the vector of leverage estimates for the
     concordance</p></dd>

   <dt>influence</dt>
<dd><p>optional, the matrix of leverage values for each of
     the counts, one row per observation</p></dd>

   <dt>ranks</dt>
<dd><p>optional, a data frame containing the Somers' d rank
     at each event time, along with the time weight, and the case weight of
     the observation.  The time weighted sum of the ranks will equal
     concordant pairs - discordant pairs.</p></dd>

 </dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>A coxph model that has a numeric failure may have undefined
  predicted values, in which case the concordance will be NULL.</p>
<p>Computation for an existing coxph model along with <code>newdata</code> has
  some subtleties with respect to extra arguments in the original call.
  These include</p><ul><li><p>tt() terms in the model.  This is not supported with newdata.</p></li>
<li><p>subset.  Any subset clause in the original call is ignored,
    i.e., not applied to the new data.</p></li>
<li><p>strata() terms in the model.  The new data is expected to
    have the strata variable(s) found in the original data set,
    with concordance computed within strata.
    The levels of the strata variable need not be
    the same as in the original data.</p></li>
<li><p>id or cluster directives.  This has not yet been sorted out.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Terry Therneau</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="coxph.html">coxph</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>F Harrell, R Califf, D Pryor, K Lee and R Rosati, 
  Evaluating the yield of medical tests, J Am Medical Assoc, 1982.</p>
<p>R Peto and J Peto,
  Asymptotically efficient rank invariant test procedures (with
  discussion), J Royal Stat Soc A, 1972.</p>  
<p>M Schemper, Cox analysis of survival data with non-proportional
  hazard functions, The Statistician, 1992.</p>
<p>H Uno, T Cai, M Pencina, R D'Agnostino and Lj Wei,
  On the C-statistics for evaluating overall adequacy of risk 
        prediction procedures with censored survival data,
	Statistics in Medicine, 2011.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">ptime</span>, <span class="va">pstat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">mspike</span>, <span class="va">mgus2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">concordance</span><span class="op">(</span><span class="va">fit1</span>, timewt<span class="op">=</span><span class="st">"n/G2"</span><span class="op">)</span>  <span class="co"># Uno's weighting</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> concordance.coxph(object = fit1, timewt = "n/G2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 1373 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Concordance= 0.6132 se= 0.1026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> concordant discordant     tied.x     tied.y    tied.xy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  461425.07  290956.09     265.66     120.39       0.00 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># logistic regression </span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">sex</span><span class="op">==</span><span class="st">'M'</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">creatinine</span><span class="op">)</span>, <span class="va">binomial</span>, data<span class="op">=</span> <span class="va">flchain</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">concordance</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>  <span class="co"># equal to the AUC</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> concordance.lm(object = fit2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 6524 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Concordance= 0.8151 se= 0.005304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> concordant discordant     tied.x     tied.y    tied.xy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8568768    1931502      31474   10689870      56412 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare multiple models </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span>   <span class="co"># predict all 1384 obs, including missing</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">pstat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">mspike</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ptime</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            <span class="va">poisson</span>, data<span class="op">=</span> <span class="va">mgus2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">ptime</span>, <span class="va">pstat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">mspike</span>, <span class="va">mgus2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">ptime</span>, <span class="va">pstat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">hgb</span> <span class="op">+</span> <span class="va">creat</span>, <span class="va">mgus2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tdata</span> <span class="op">&lt;-</span> <span class="va">mgus2</span>; <span class="va">tdata</span><span class="op">$</span><span class="va">ptime</span> <span class="op">&lt;-</span> <span class="fl">60</span>   <span class="co"># prediction at 60 months</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit3</span>, newdata<span class="op">=</span><span class="va">tdata</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">)</span> <span class="co"># high risk scores predict shorter survival</span></span></span>
<span class="r-in"><span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span>      <span class="co"># return to the R default</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cfit</span> <span class="op">&lt;-</span> <span class="fu">concordance</span><span class="op">(</span><span class="fu"><a href="Surv.html">Surv</a></span><span class="op">(</span><span class="va">ptime</span>, <span class="va">pstat</span><span class="op">)</span> <span class="op">~</span><span class="va">p3</span> <span class="op">+</span>  <span class="va">p4</span> <span class="op">+</span> <span class="va">p5</span>, <span class="va">mgus2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cfit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> concordance.formula(object = Surv(ptime, pstat) ~ p3 + p4 + p5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = mgus2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n=1338 (46 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    concordance     se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p3      0.6598 0.0313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p4      0.6618 0.0310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p5      0.6000 0.0293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    concordant discordant tied.x tied.y tied.xy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p3      51105      26333     74     28       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p4      51258      26180     74     28       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p5      46507      31003      2     28       0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cfit</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    p3    p4    p5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.660 0.662 0.600 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">cfit</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>  <span class="co"># high correlation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.000 0.994 0.236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.994 1.000 0.258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.236 0.258 1.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># contrast vector for model 1 - model 2 </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="va">test</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cfit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        sd<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">cfit</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">test</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference         sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.002      0.003 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Terry M Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

