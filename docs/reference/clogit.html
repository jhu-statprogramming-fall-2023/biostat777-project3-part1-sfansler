<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates a logistic regression model by maximising the conditional
  likelihood. Uses a model formula of the form
  case.status~exposure+strata(matched.set).
  The default is to use the exact conditional likelihood, a commonly
  used approximate conditional likelihood is provided for compatibility
  with older software."><title>Conditional logistic regression — clogit • survival</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conditional logistic regression — clogit"><meta property="og:description" content="Estimates a logistic regression model by maximising the conditional
  likelihood. Uses a model formula of the form
  case.status~exposure+strata(matched.set).
  The default is to use the exact conditional likelihood, a commonly
  used approximate conditional likelihood is provided for compatibility
  with older software."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">survival</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example-analysis.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/therneau/survival/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Conditional logistic regression</h1>
      
      <div class="d-none name"><code>clogit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates a logistic regression model by maximising the conditional
  likelihood. Uses a model formula of the form
  <code>case.status~exposure+strata(matched.set)</code>.
  The default is to use the exact conditional likelihood, a commonly
  used approximate conditional likelihood is provided for compatibility
  with older software.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clogit</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">weights</span>, <span class="va">subset</span>, <span class="va">na.action</span>,</span>
<span> method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exact"</span>, <span class="st">"approximate"</span>, <span class="st">"efron"</span>, <span class="st">"breslow"</span><span class="op">)</span>,</span>
<span> <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula</p></dd>

  <dt>data</dt>
<dd><p>data frame</p></dd>

  <dt>weights</dt>
<dd><p>optional, names the variable containing case weights</p></dd>

  <dt>subset</dt>
<dd><p>optional, subset the data</p></dd>

  <dt>na.action</dt>
<dd><p>optional na.action argument.  By default the
    global option <code>na.action</code> is used.</p></dd>

  <dt>method</dt>
<dd><p>use the correct (exact) calculation in the conditional
    likelihood or one of the approximations</p></dd>

  <dt>...</dt>
<dd><p>optional arguments, which will be passed to
  <code>coxph.control</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>"clogit"</code>, which is a wrapper for a</p>
<p></p>
<p><code>"coxph"</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Lumley</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It turns out that the loglikelihood for a conditional logistic
  regression model = loglik from a Cox model with a particular data
  structure.  Proving this is a nice homework exercise for a PhD
  statistics class; not too hard, but the fact that it is true is
  surprising.</p>
<p>When a well tested Cox model routine is available many packages use
  this `trick' rather than writing a new software routine from
  scratch, and this is what the clogit routine does.
  In detail,  a stratified Cox model with each case/control group
  assigned to its own stratum, time set to a constant,
  status of 1=case 0=control,
  and using the exact partial likelihood has the same likelihood formula
  as a conditional logistic regression.  The clogit routine creates
  the necessary dummy variable of times (all 1) and the strata,
  then calls coxph.</p>
<p>The computation of the exact partial likelihood can be very slow,
  however.  If a particular strata had say 10 events out of 20 subjects
  we have to add up a denominator that involves all possible ways of
  choosing 10 out of 20, which is 20!/(10! 10!) = 184756 terms. Gail et
  al describe a fast recursion method which partly ameliorates
  this; it was incorporated into version 2.36-11 of the survival
  package.  The computation remains infeasible for very large groups of
  ties, say 100 ties out of 500 subjects, and may even lead to integer
  overflow for the subscripts -- in this latter case the routine will
  refuse to undertake the task.  The Efron approximation is normally a
  sufficiently accurate substitute.</p>
<p>Most of the time conditional logistic modeling 
  is applied data with 1 case + k controls per set, in
  which case all of the approximations for ties lead to exactly the
  same result.  
  The 'approximate' option maps to the
  Breslow approximation for the Cox model, for historical reasons.</p>
<p>Case weights are not allowed when the exact option is used, as the
  likelihood is not defined for fractional weights.
  Even with integer case weights it is not clear how they should be  
  handled.  For instance if
  there are two deaths in a strata, one with weight=1 and one with
  weight=2, should the likelihood calculation consider all subsets of
  size 2 or all subsets of size 3?
  Consequently, case weights are ignored by the routine in this case.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="strata.html">strata</a></code>,<code><a href="coxph.html">coxph</a></code>,<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Michell H Gail, Jay H Lubin and Lawrence V Rubinstein.  Likelihood
calculations for matched case-control studies and survival studies with
tied death times.  Biometrika 68:703-707, 1980.</p>
<p>John A. Logan. A multivariate model for mobility tables.
Am J Sociology 89:324-349, 1983.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu">clogit</span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">spontaneous</span> <span class="op">+</span> <span class="va">induced</span> <span class="op">+</span> <span class="fu"><a href="strata.html">strata</a></span><span class="op">(</span><span class="va">stratum</span><span class="op">)</span>, data<span class="op">=</span><span class="va">infert</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A multinomial response recoded to use clogit</span></span></span>
<span class="r-in"><span><span class="co">#  The revised data set has one copy per possible outcome level, with new</span></span></span>
<span class="r-in"><span><span class="co">#  variable tocc = target occupation for this copy, and case = whether</span></span></span>
<span class="r-in"><span><span class="co">#  that is the actual outcome for each subject.</span></span></span>
<span class="r-in"><span><span class="co"># See the reference below for the data.</span></span></span>
<span class="r-in"><span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">logan</span><span class="op">$</span><span class="va">occupation</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">logan</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">indx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">logan2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">logan</span><span class="op">[</span><span class="va">indx</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>                     id <span class="op">=</span> <span class="va">indx</span>,</span></span>
<span class="r-in"><span>                     tocc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">resp</span>, each<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">logan2</span><span class="op">$</span><span class="va">case</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">logan2</span><span class="op">$</span><span class="va">occupation</span> <span class="op">==</span> <span class="va">logan2</span><span class="op">$</span><span class="va">tocc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">clogit</span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">tocc</span> <span class="op">+</span> <span class="va">tocc</span><span class="op">:</span><span class="va">education</span> <span class="op">+</span> <span class="fu"><a href="strata.html">strata</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, <span class="va">logan2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clogit(case ~ tocc + tocc:education + strata(id), logan2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  coef  exp(coef)   se(coef)       z        p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccfarm                   -1.8964629  0.1500986  1.3807822  -1.373  0.16961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccoperatives              1.1667502  3.2115388  0.5656465   2.063  0.03914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccprofessional           -8.1005492  0.0003034  0.6987244 -11.593  &lt; 2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccsales                  -5.0292297  0.0065438  0.7700862  -6.531 6.54e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tocccraftsmen:education    -0.3322842  0.7172835  0.0568682  -5.843 5.13e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccfarm:education         -0.3702858  0.6905370  0.1164100  -3.181  0.00147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccoperatives:education   -0.4222188  0.6555906  0.0584328  -7.226 4.98e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccprofessional:education  0.2782469  1.3208122  0.0510212   5.454 4.94e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> toccsales:education                NA         NA  0.0000000      NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test=665.5  on 8 df, p=&lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 4190, number of events= 838 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Terry M Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

